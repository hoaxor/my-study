# 树

## 定义

树是一种常用的数据结构，由n个有限节点组成一个有层次结构的集合，最顶层只有一个节点称为根节点。

每个节点有零个或多个子节点，没有父节点的成为称为根节点；每一个非根节点有且只有一个父节点；除了根节点外，每个子节点可以分为多个不相交的子树。

空集合也是树，称为空树。

父节点、兄弟节点、堂兄弟节点。。。

**深度**：定义一棵树的根结点层次为1，其他结点的层次是其[父结点](https://baike.baidu.com/item/父结点/9796346)层次加1。一棵树中所有结点的层次的最大值称为这棵树的深度。

**遍历方法**：[先序遍历](https://baike.baidu.com/item/先序遍历/6442839)（根-左-右）、[中序遍历](https://baike.baidu.com/item/中序遍历/757281)（左-根-右）（仅二叉树有[中序遍历](https://baike.baidu.com/item/中序遍历/757281)）、[后序遍历](https://baike.baidu.com/item/后序遍历/1214806)（左-右-根）、层次遍历

## 种类

无序树：树中任意节点的子结点之间没有顺序关系，这种树称为无序树,也称为自由树；

[有序树](https://baike.baidu.com/item/有序树)：树中任意节点的子结点之间有顺序关系，这种树称为有序树；

[二叉树](https://baike.baidu.com/item/二叉树/1602879)：每个节点最多含有两个子树的树称为二叉树；

[满二叉树](https://baike.baidu.com/item/满二叉树)：叶节点除外的所有节点均含有两个子树的树被称为满二叉树；

[完全二叉树](https://baike.baidu.com/item/完全二叉树)：除最后一层外，所有层都是满节点，且最后一层缺右边连续节点的二叉树称为完全二叉树；

[哈夫曼树](https://baike.baidu.com/item/哈夫曼树/2305769)（最优二叉树）：带权路径最短的二叉树称为哈夫曼树或最优二叉树。

## 

## 常用树介绍

### 二叉搜索树（Binary search tree）

#### 定义

某节点的左子树节点值仅包含小于该节点值

某节点的右子树节点值仅包含大于该节点值

左右子树每个也必须是二叉查找树

![二叉搜索树](https://pic1.zhimg.com/v2-2c4313340f8eaaf8139c692c8cbf4fd4_b.jpg)

#### 时间复杂度

最优时间复杂度为O(log N)

二叉搜索树可能退化成链表，查找时间复杂度O(N)。

### 平衡二叉树（AVL）

#### 定义

平衡二叉树是由前苏联的两位数学家G.M.Adelse-Velskil和E.M.Landis提出，因此一般也称作AVL树，AVL树本质还是一棵二叉查找树，只是在其基础上增加了“平衡”的要求。所谓平衡是指，对AVL树的任意结点来说，其左子树与右子树的高度之差的绝对值不超过1，其中左子树与右子树的高度因子之差称为平衡因子。

- 左子树与右子树高度之差的绝对值不超过1
- 树的每个左子树和右子树都是AVL树
- 每一个节点都有一个平衡因子（balance factor），任一节点的平衡因子是-1、0、1（每一个节点的平衡因子 = 右子树高度 - 左子树高度）

#### 插入元素

表：从最靠近插入结点的失衡结点处，通过对子树调整，使整棵树的每个结点的平衡因子变为正常

| 插入方式 | 描述                                                     | 旋转方式     |
| -------- | -------------------------------------------------------- | ------------ |
| LL       | 在某节点**左子树**根节点的**左子树**上插入节点而破坏平衡 | 右旋         |
| RR       | 在某节点**右子树**根节点的**右子树**上插入节点而破坏平衡 | 左旋         |
| LR       | 在某节点**左子树**根节点的**右子树**上插入节点而破坏平衡 | 先左旋后右旋 |
| RL       | 在某节点**右子树**根节点的**左子树**上插入节点而破坏平衡 | 先右旋后左旋 |

![LL](https://images2018.cnblogs.com/blog/1128337/201808/1128337-20180810155654373-398180274.png)

![RR](https://images2018.cnblogs.com/blog/1128337/201808/1128337-20180810161201733-1806220301.png)

![LR](https://images2018.cnblogs.com/blog/1128337/201808/1128337-20180810162937013-1788550109.png)

![RL](https://images2018.cnblogs.com/blog/1128337/201808/1128337-20180810163030305-647234520.png)

### 红黑树（Red black tree）

#### 定义

红黑树是在1972年由[Rudolf Bayer](https://baike.baidu.com/item/Rudolf Bayer/3014716)发明的，当时被称为平衡二叉B树（symmetric binary B-trees）。后来，在1978年被 Leo J. Guibas 和 Robert Sedgewick 修改为如今的“红黑树”。

红黑树是一种平衡二叉查找树的变体，它的左右子树高差有可能大于 1，所以红黑树不是严格意义上的[平衡二叉树](https://baike.baidu.com/item/平衡二叉树/10421057)（AVL），但 对之进行平衡的代价较低， 其平均统计性能要强于 AVL 。

#### 性质

红黑树是每个节点都带有颜色属性的二叉查找树，除了二叉查找树的要求外，红黑树还有如下特性（有红必有黑，红红不相连）。

1. 节点是红色或黑色。
2. 根节点是黑色。
3. 所有NIL节点都是黑色的。<a id=nil>NIL节点</a>即叶子节点下挂的两个虚节点。
4. 每个红色节点的两个子节点都是黑色，（从每个叶子节点到根的所有路径上不能有两个连续的红色节点）。
5. 对任意递归子树，根节点到叶子节点的所有路径上包含相同数量的黑色节点。

上述5个约束条件保证了红黑树的新增、删除和查找的最坏时间复杂度均为O(log N)，**红黑树的任何旋转在三次之内均可完成**。

#### 复杂度分析

黑深度（Black Depth）是指当前节点到[NIL节点](#nil)途径的黑色节点个数。根据约束条件第四条和第五条可以推出对于高度为height的节点，黑深度 >= height / 2



#### 红黑树插入元素

1. 将新插入的节点标记为红色

2. 如果 X 是根结点(root)，则标记为黑色

3. 如果 X 的 parent 不是黑色（是红色），同时 X 也不是 root:

   3.1 如果 X 的 uncle (叔叔) 是红色（[见图](#uncle-red)）

- ​	3.1.1 将 parent 和 uncle 标记为黑色

- ​	3.1.2 将 grand parent (祖父) 标记为红色

- ​	3.1.3 让 X 节点的颜色与 X 祖父的颜色相同，然后重复步骤 2、3	

- 3.2 如果 X 的 uncle (叔叔) 是黑色，我们要分四种情况处理（[见图](#uncle-black)）

- ​	3.2.1 左左 (P 是 G 的左孩子，并且 X 是 P 的左孩子)（[见图](#rbt-ll)）

- ​	3.2.2 左右 (P 是 G 的左孩子，并且 X 是 P 的右孩子)（[见图](#rbt-lr)）

- ​	3.2.3 右右 (和 3.2.1 镜像过来，恰好相反)（[见图](#rbt-rr)）

- ​	3.2.4 右左 (和 3.2.2 镜像过来，恰好相反)（[见图](#rbt-rl)）

- <a id="uncle-red">**叔叔是红色**</a>

- ![叔叔节点是红色](https://pic4.zhimg.com/v2-1d35b926316397d82c267593042f8c3f_b.jpg)

- <a id="uncle-black">**叔叔是黑色**</a>

- ​	<a id="rbt-ll">**左左**</a>

- ![img](https://pic1.zhimg.com/v2-9e139a0f8b4a5e00ca8e643e2130403c_b.jpg)

- <a id="rbt-lr">**左右**</a>

- ![img](https://pic4.zhimg.com/v2-3fb33fbb3a42e34ed8a058a047a44cc3_b.jpg)

- <a id="rbt-rr">**右右**</a>

- ![img](https://pic4.zhimg.com/v2-62a42ada09cb4547191aa4b9051c7c23_b.jpg)

- <a id="rbt-rl">**右左**</a>

- ![img](https://pic4.zhimg.com/v2-210d1400ea1b098dfe1582589a6064c3_b.jpg)

